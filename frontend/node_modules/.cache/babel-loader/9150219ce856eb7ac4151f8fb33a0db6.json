{"ast":null,"code":"var _jsxFileName = \"/Users/victorlieu/Desktop/Development/404Project/frontend/src/components/Posts/PublicPosts.js\";\nimport React from \"react\";\nimport requests from \"../../requests\";\nimport { Grid } from \"@mui/material\";\nimport Post from \"../Inbox/Post\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass PublicPosts extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.getAllPosts = async () => {\n      try {\n        // Get all the author details\n        const response = await requests.get(`service/authors/${this.state.currentUser.id}/posts/`, {\n          headers: {\n            Authorization: localStorage.getItem('access_token'),\n            accept: 'application/json'\n          }\n        }); // get list of likes for each post\n\n        const postPromises = response.data.items.map(async item => {\n          if (item.type === 'post') {\n            const like_response = await requests.get(`service/authors/${item.author.id}/posts/${item.id}/likes/`);\n            item.likes = like_response.data.items;\n            item.likedByCurrent = false; // check if current viewer liked the post\n\n            item.likes.forEach(like => {\n              if (like.author === this.state.currentUser.id) {\n                item.likedByCurrent = true;\n              }\n            });\n          }\n\n          return item;\n        }); // wait for promises then set inbox list\n\n        const postList = await Promise.all(postPromises);\n        this.setState({\n          allPosts: postList\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    };\n\n    this.initializeDetails = async () => {\n      try {\n        // Get the author details\n        const response = await requests.get('service/get-user/', {\n          headers: {\n            Authorization: localStorage.getItem('access_token'),\n            accept: 'application/json'\n          }\n        });\n        this.setState({\n          currentUser: {\n            id: response.data.id ? response.data.id : '',\n            url: response.data.url ? response.data.url : '',\n            host: response.data.host ? response.data.host : '',\n            displayName: response.data.displayName ? response.data.displayName : '',\n            github: response.data.github ? response.data.github : '',\n            profileImage: response.data.profileImage ? response.data.profileImage : ''\n          }\n        });\n        this.getAllPosts();\n      } catch (error) {\n        console.log(error);\n      }\n    };\n\n    this.state = {\n      currentUser: {},\n      allPosts: {}\n    };\n  }\n\n  componentDidMount() {\n    this.initializeDetails();\n  }\n\n  renderInboxItems() {\n    return this.state.allPosts.map(item => {\n      if (item.type === 'post') {\n        return /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 8,\n          children: /*#__PURE__*/_jsxDEV(Post, {\n            post: item,\n            currentUser: this.state.currentUser,\n            likes: item.likes,\n            likedByCurrent: item.likedByCurrent,\n            isPublic: item.visibility === 'PUBLIC' && item.viewableBy === ''\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 13\n        }, this);\n      }\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"PublicPosts\",\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        p: 2,\n        justifyContent: \"center\",\n        alignItem: \"center\",\n        direction: \"column\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 2,\n        justifyContent: \"center\",\n        alignItem: \"center\",\n        children: this.state.allPosts.length ? this.renderInboxItems() : /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Inbox is empty\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 69\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 11\n    }, this);\n  }\n\n}\n\nexport default PublicPosts;","map":{"version":3,"sources":["/Users/victorlieu/Desktop/Development/404Project/frontend/src/components/Posts/PublicPosts.js"],"names":["React","requests","Grid","Post","PublicPosts","Component","constructor","props","getAllPosts","response","get","state","currentUser","id","headers","Authorization","localStorage","getItem","accept","postPromises","data","items","map","item","type","like_response","author","likes","likedByCurrent","forEach","like","postList","Promise","all","setState","allPosts","error","console","log","initializeDetails","url","host","displayName","github","profileImage","componentDidMount","renderInboxItems","visibility","viewableBy","render","length"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport requests from \"../../requests\";\nimport { Grid } from \"@mui/material\";\nimport Post from \"../Inbox/Post\";\n\n  \nclass PublicPosts extends React.Component {\n  constructor(props){\n    super(props);\n    this.state = {\n        currentUser: {},\n        allPosts: {},\n    }\n}\n\n  componentDidMount() {\n      this.initializeDetails();\n  }\n\n  getAllPosts = async () => {\n    try {\n        // Get all the author details\n        const response = await requests.get(`service/authors/${this.state.currentUser.id}/posts/`, {headers: {\n            Authorization: localStorage.getItem('access_token'),\n            accept: 'application/json',\n        }});\n        \n        // get list of likes for each post\n        const postPromises = response.data.items.map(async (item) => {\n          if (item.type === 'post') {\n            const like_response = await requests.get(`service/authors/${item.author.id}/posts/${item.id}/likes/`);\n            item.likes = like_response.data.items;\n            item.likedByCurrent = false;\n            // check if current viewer liked the post\n            item.likes.forEach((like) => {\n              if (like.author === this.state.currentUser.id) {\n                item.likedByCurrent = true;\n              }\n            })\n          }\n          return item;\n        })\n        // wait for promises then set inbox list\n        const postList = await Promise.all(postPromises)\n        this.setState({ allPosts: postList });\n    } catch(error) {\n        console.log(error)\n    }\n  }\n\n  initializeDetails = async () => {\n      try {\n          // Get the author details\n          const response = await requests.get('service/get-user/', {headers: {\n              Authorization: localStorage.getItem('access_token'),\n              accept: 'application/json',\n          }});\n          this.setState({ currentUser: {\n              id: response.data.id ? response.data.id : '',\n              url: response.data.url ? response.data.url : '',\n              host: response.data.host ? response.data.host : '',\n              displayName: response.data.displayName ? response.data.displayName : '',\n              github: response.data.github ? response.data.github : '',\n              profileImage: response.data.profileImage ? response.data.profileImage : ''\n          }});\n\n        this.getAllPosts();\n\n      } catch(error) {\n          console.log(error)\n      }\n  }\n\n  renderInboxItems() {\n    return this.state.allPosts.map((item) => {\n        if (item.type === 'post') {\n          return (\n            <Grid item xs={8}>\n              <Post   \n              post= {item}\n              currentUser={this.state.currentUser}\n              likes={item.likes}\n              likedByCurrent={item.likedByCurrent}\n              isPublic={item.visibility === 'PUBLIC' && item.viewableBy === ''}\n              />\n            </Grid>\n          );\n        }\n    });\n  }\n\n  render(){\n      return (\n          <div className=\"PublicPosts\">\n            <Grid container p={2}\n            justifyContent=\"center\"\n            alignItem=\"center\"\n            direction=\"column\">\n            </Grid>\n          <Grid container spacing={2} justifyContent=\"center\" alignItem=\"center\">\n            {this.state.allPosts.length ? this.renderInboxItems() : <h2>Inbox is empty</h2>}\n          </Grid>\n          </div>\n      )\n  }\n}\n\nexport default PublicPosts;\n"]},"metadata":{},"sourceType":"module"}